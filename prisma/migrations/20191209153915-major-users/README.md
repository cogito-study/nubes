# Migration `20191209153915-major-users`

This migration has been generated by Mate Papp <mate.papp@cogito.study> at 12/9/2019, 3:39:15 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."User" ADD COLUMN "major" text   REFERENCES "public"."Major"("id") ON DELETE SET NULL;
```

## Changes

```diff
diff --git datamodel.mdl datamodel.mdl
migration 20191205193805-auth-refactor..20191209153915-major-users
--- datamodel.dml
+++ datamodel.dml
@@ -1,6 +1,6 @@
 datasource postgres {
-  url = "***"
+  url      = env("POSTGRESQL_URL")
   provider = "postgres"
 }
 generator photon {
@@ -66,8 +66,9 @@
   id          String            @default(cuid()) @id @unique
   name        String
   faculty     Faculty           @relation(name: "FacultyMajors")
   subjects    Subject[]         @relation(name: "MajorSubjects")
+  users       User[]            @relation(name: "MajorUsers")
   permissions MajorPermission[] @relation(name: "MajorPermissions")
   createdAt   DateTime          @default(now())
   updatedAt   DateTime          @updatedAt
   deletedAt   DateTime?
@@ -197,8 +198,9 @@
   activationToken     ActivationToken?
   ResetPasswordToken  ResetPasswordToken?
   isActive            Boolean             @default(false)
   role                UserRole?           @relation(name: "UserRole")
+  major               Major?              @relation(name: "MajorUsers")
   notes               Note[]              @relation(name: "NoteAuthors")
   noteHighlights      NoteHighlight[]     @relation(name: "UserNoteHighlights")
   suggestions         Suggestion[]        @relation(name: "SuggestionAuthor")
   approvedSuggestions Suggestion[]        @relation(name: "SuggestionApprovedBy")
```

## Photon Usage

You can use a specific Photon built for this migration (20191209153915-major-users)
in your `before` or `after` migration script like this:

```ts
import Photon from '@generated/photon/20191209153915-major-users'

const photon = new Photon()

async function main() {
  const result = await photon.users()
  console.dir(result, { depth: null })
}

main()

```
